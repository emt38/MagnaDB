<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css" />
        <link rel="stylesheet" type="text/css" href="css/content.css" />
        <link rel="icon" href="resources/favicon.ico" />
        <title>MagnaDB.NET</title>
    </head>
    <body>
        <nav class="navbar navbar-expand-lg fixed-top navbar-dark bg-primary">
            <a class="navbar-brand" href="index.html">MagnaDB</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarColor01" aria-controls="navbarColor01" aria-expanded="false" aria-label="Toggle navigation">
              <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarColor01">
              <ul class="navbar-nav mr-auto">
                <li class="nav-item active">
                  <a class="nav-link" href="index.html">Home <span class="sr-only">(current)</span></a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="examples.html">Examples</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="about.html">About</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="utilities.html">Utilities</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="download.html">Download</a>
                </li>
              </ul>
            </div>
          </nav>
          <div class="container body-content">
            <h1>MagnaDB Framework for <span class="badge badge-info">.NET</span></h1>
            <div class="row">
              <div class="col-lg-3 col-md-4">
                <h4>Table of Contents</h4>
                <div id="contentSpy" class="bevel bg-light">
                  <div class="bevel-content">
                    <ul class="nav nav-pills flex-column">
                      <li class="nav-item">
                        <a class="nav-link active" href="#overview">1. Overview</a>
                      </li>
                      <li class="nav-item">
                        <a class="nav-link" href="#getting-started">2. Getting Started</a>
                      </li>
                      <li class="nav-item">
                        <a class="nav-link" href="#table-model">3. Table Models</a>
                      </li>
                      <li class="nav-item">
                        <a class="nav-link" href="#view-model">4. View Models</a>
                      </li>
                      <li class="nav-item">
                        <a class="nav-link" href="#methods">5. Methods</a>
                      </li>
                      <li class="nav-item">
                        <a class="nav-link" href="#attributes">6. Attributes</a>
                      </li>
                      <li class="nav-item">
                        <a class="nav-link" href="#events">7. Events</a>
                      </li>
                      <li class="nav-item">
                        <a class="nav-link" href="#exceptions">8. Exceptions</a>
                      </li>
                      <li class="nav-item">
                        <a class="nav-link" href="#dbengines">9. DB Engines</a>
                      </li>
                    </ul>
                  </div>
                </div>
              </div>
              <div class="col-lg-9 col-md-8" style="overflow-y: auto; max-height: 75vh;"  data-spy="scroll" data-target="#contentSpy" data-offset="20">
                <section id="overview">
                  <h2>1. Overview</h2>
                  <div class="w-100 d-flex" style="height: 220px;">
                    <br /><br />
                    <div class="mx-auto" style="background-repeat: no-repeat; width: 200px; background-size: contain; background-image: url(resources/MagnaLogo.png);"></div>
                  </div>
                  <h4><strong>A simple ORM to make things simpler</strong></h4>
                  <p>
                    MagnaDB is a fast and reliable ORM that makes you worry less about databases
                    and lets you code peacefully.
                    <br />
                    This framework packs Code-First capabilities, as well as Database-First easy
                    integration. It'll go with you, the path you decide to take.<br />
                    <br />
                    You're on the No-SQL train? <b>This is for you.</b><br />
                    You still love SQL like the first time? <b>This is for you.</b><br />
                    <br />
                    MagnaDB is designed to be a Hybrid ORM, letting you manipulate databases
                    objects directly from the code, but also letting the window open databases
                    commands to get in. <b>All this while keeping you safe.</b>
                  </p>
                </section>
                <section id="getting-started">
                  <h2>2. Getting Started</h2>
                  <p>
                    In order to get started we first need to install MagnaDB to one of our
                    projects.<br />
                    <br>
                    For the present example let's create a new Console Application Project
                    for .NET Framework. Let's name it <span class="text-info">TestMagnaDB</span>
                    (or whatever you wish to name it. It's up to you).<br />
                    <br />
                    If you're using Visual Studio, or Visual Studio Code (with the NuGet
                    Package Manager extension) you just need to execute the following command
                    in the NuGet Package Manager Console.
                    <br>
                    <div class="bg-dark p-2">
                      <code class="text-light">
                        PM> Install-Package MagnaDB.SQLite
                      </code>
                    </div>
                    <br />
                    This command will download the latest version of MagnaDB for SQLite (note: MagnaDB
                    is available for SQL Server and MySQL; if you have any of these DB engines available
                    you're free to try MagnaDB in any of them. <a href="#dbengines"> learn more</a>).<br />
                    <br />
                    <span class="text-info">Please make sure your project's target framework is &GreaterEqual; .NET Framework 4.6.1</span>
                  </p>
                </section>
                <section id="table-model">
                  <h2>3. Table Models</h2>
                  <p>
                    After you have successfully installed MagnaDB to your project, the next step is to create
                    some <strong>models.</strong><br />
                    We'll start with a Table Model.<br />
                    <br />
                    A TableModel is a class that resembles a Table definition in a database,
                    and objects from this class are mapped to a row from this table in the database
                    through their properties.<br>
                    <br />
                    Let's create a <span class="text-primary">Cat</span> model (you
                    can do this by creating a new Class file in your project; name it <i>Cat</i>); it will have
                    the following properties: Id, Name, Race, DateOfBirth.<br />
                    <br>
                    It would look something like this:
                    <div class="bg-dark p-2">
                      <code>
<pre class="text-light" style="font-size: 14px;">
<span class="text-primary">using</span> System;
<span class="text-primary">using</span> MagnaDB.SQLite;

<span class="text-primary">namespace</span> TestMagnaDB
{
    <span class="text-primary">public class</span> <span class="text-info">Cat</span>
    {
        <span class="text-primary">public long</span> Id { <span class="text-primary">get</span>; <span class="text-primary">set</span>; }
        <span class="text-primary">public string</span> Name { <span class="text-primary">get</span>; <span class="text-primary">set</span>; }
        <span class="text-primary">public string</span> Breed { <span class="text-primary">get</span>; <span class="text-primary">set</span>; }
        <span class="text-primary">public</span> <span class="text-info">DateTime</span> DateOfBirth { <span class="text-primary">get</span>; <span class="text-primary">set</span>; }
    }
}
</pre>
                      </code>
                    </div>
                    <br>
                    The previous example shows a minimally defined model. But, it's not a MagnaDB
                    Table model. In order to make it a table model, Cat must inherit the
                    MagnaDB.TableModel&LeftAngleBracket;T&RightAngleBracket; abstract class and
                    define the following abstract properties implementation:
                    <b>ConnectionString, TableName, Key.</b><br />
                    <br />
                    <div class="bg-dark p-2">
                      <code>
<pre class="text-light" style="font-size: 14px;">
<span class="text-primary">using</span> System;
<span class="text-primary">using</span> MagnaDB.SQLite;

<span class="text-primary">namespace</span> TestMagnaDB
{
    <span class="text-primary">public class</span> <span class="text-info">Cat</span> : <span class="text-info">TableModel<span class="text-light">&lt;</span>Cat<span class="text-light">&gt;</span></span>
    {
        <span class="text-primary">protected override string</span> ConnectionString => <span class="text-brick">"Data Source=testmagna.db;New=True;Version=3;"</span>;
        <span class="text-primary">protected override string</span> TableName => <span class="text-brick">"Cats"</span>;
        <span class="text-primary">protected override</span> <span class="text-info">MagnaKey</span> Key => <span class="text-primary">this</span>.<span class="text-cream">MakeKey</span>(<span class="text-info">cat</span> => <span class="text-info">cat</span>.Id);

        [<span class="text-info">Identity</span>]
        <span class="text-primary">public long</span> Id { <span class="text-primary">get</span>; <span class="text-primary">set</span>; }
        <span class="text-primary">public string</span> Name { <span class="text-primary">get</span>; <span class="text-primary">set</span>; }
        <span class="text-primary">public string</span> Breed { <span class="text-primary">get</span>; <span class="text-primary">set</span>; }
        <span class="text-primary">public</span> <span class="text-info">DateTime</span> DateOfBirth { <span class="text-primary">get</span>; <span class="text-primary">set</span>; }
    }
}
</pre>
                      </code>
                    </div>
                    <br />
                    <ul>
                      <li>
                        <b>TableModel&lt;T&gt;:</b> this class must be inherited when creating a table model
                        and contains all methods and functions concerning them. The implementing class
                        must be specified as the type parameter when defining the inheritance (as seen in
                        the example above).
                      </li>
                      <li>
                        <b>ConnectionString:</b> this propery must return a string containing the properties
                        connection string (formats may vary from one DB Engine to another, please see the
                        <a href="#dbengines"> DB Engines</a>) for more information.
                      </li>
                      <li>
                        <b>TableName:</b> this propery must return a string containing the name of the
                        database table which this class will be mapped to.
                      </li>
                      <li>
                        <b>Key:</b> this propery must return a MagnaKey object containg a Key/Value
                        combination of the properties that compose the primary key for the class/table
                        (the use of the extension method <span class="text-primary">MakeKey</span>()
                        is preferred, and should provide an easier way to specify all columns composing
                        the primary key).
                      </li>
                      <li>
                        <b>IdentityAttribute [Identity]:</b> this attribute indicates that the property
                        it is decorating will be used as an Identity or Auto Increment column. <a href="#attributes">Learn more</a>
                      </li>
                    </ul>
                    <br />
                    Now that we have correctly defined our model, let's use it in our Main
                    Function in the <i>Program.cs</i> file.<br />
                    <br />
                    <div class="bg-dark p-2">
                      <code>
<pre class="text-light" style="font-size: 14px;">
<span class="text-primary">using</span> System;

<span class="text-primary">namespace</span> TestMagnaDB
{
    <span class="text-primary">class</span> <span class="text-info">Program</span>
    {
        <span class="text-primary">static void</span> Main(<span class="text-primary">string</span>[] args)
        {
            <span class="text-olive">// First things, first, let's create our Cat Table</span>
            <span class="text-olive">// If a table already exists in the database, we'll</span>
            <span class="text-olive">// have an exception thrown, so we'll use try/catch</span>
            <span class="text-primary">try</span>
            {
                <span class="text-info">Cat</span>.CreateTable();
            }
            <span class="text-primary">catch</span>
            {
                <span class="text-olive">// The table already exists.</span>
            }
            
            <span class="text-olive">// Next, we'll create a new Cat object</span>
            <span class="text-info">Cat</span> milo = new <span class="text-info">Cat</span>()
            {
                Name = <span class="text-brick">"Milo"</span>,
                Breed = <span class="text-brick">"Persian"</span>,
                DateOfBirth = <span class="text-primary">new</span> <span class="text-info">DateTime</span>(2019, 11, 7)
            };

            <span class="text-olive">// Let's insert Milo to the DB</span>
            milo.Insert();

            <span class="text-olive">// After a TableModel object is successfully inserted to the database</span>
            <span class="text-olive">// it will have its Identity marked property (if any) automatically updated</span>
            <span class="text-info">Console</span>.WriteLine(<span class="text-brick">"{0}, the {1} cat's Id is {2}"</span>, milo.Name, milo.Breed, milo.Id);

            <span class="text-olive">// Turns out Milo's not a Persian, but an American Shorthair</span>
            <span class="text-olive">// We'll fix this and update Milo's breed in the database</span>
            milo.Breed = <span class="text-brick">"American Shorthair"</span>;
            milo.Update();

            <span class="text-olive">// If we want to retrieve Milo's information from the database</span>
            <span class="text-olive">// we can do so by using the Get() static method, and providing Milo's Id</span>
            <span class="text-olive">// as an argument. This works for classes with Identity marked properties.</span>
            <span class="text-info">Cat</span> miloFromTheDB = <span class="text-info">Cat</span>.Get(milo.Id);

            <span class="text-info">Console</span>.WriteLine(<span class="text-brick">"This kitten's name is {0}"</span>, miloFromTheDB.Name);
            <span class="text-info">Console</span>.WriteLine(<span class="text-brick">"It's a(n) {0}"</span>, miloFromTheDB.Breed);
            <span class="text-info">Console</span>.WriteLine(<span class="text-brick">"It was born on {0:MMM dd yyyy}"</span>, miloFromTheDB.DateOfBirth);
            <span class="text-info">Console</span>.WriteLine(<span class="text-brick">"{0}Press any key to continue..."</span>, Environment.NewLine);
            <span class="text-info">Console</span>.ReadKey();
        }
    }
}
</pre>
                      </code>
                    </div>
                    <br />
                  </p>
                </section>
                <section id="view-model">
                  <h2>4. View Models</h2>
                  <p>
                    MagnaDB View Models are models that are only used to retrieve information from
                    the database, meaning they are SELECT Only.<br />
                    <br />
                    Even though Views are created from existing tables (in engines like SQL Server, 
                    or MySql), which means they derive from Tables; in MagnaDB, TableModel is a ViewModel's
                    subclass (which is useful to know), and therefore
                    all operations done with ViewModel can be done with TableModel. <br />
                    <br />
                    <strong>ViewModels DO NOT have to point to a VIEW in order to work.</strong>
                    <br /> They can perfectly point at a Table, and query one or more of 
                    its columns with no issues.<br />
                    <br />
                    Let's create a new Class file in our project which we previously created (sections 
                    <a href="#getting-started">2.</a>, <a href="#table-model">3.</a>) which we'll name
                    <i>CatView.cs</i><br />
                    <div class="bg-dark p-2">
                      <code>
<pre class="text-light" style="font-size: 14px;">
<span class="text-primary">using</span> System;
<span class="text-primary">using</span> MagnaDB.SQLite;

<span class="text-primary">namespace</span> TestMagnaDB
{
    <span class="text-primary">public class</span> <span class="text-info">CatView</span> : <span class="text-info">ViewModel<span class="text-light">&lt;</span>CatView<span class="text-light">&gt;</span></span>
    {
        <span class="text-primary">protected override string</span> ConnectionString => <span class="text-brick">"Data Source=testmagna.db;New=True;Version=3;"</span>;
        <span class="text-primary">protected override string</span> TableName => <span class="text-brick">"Cats"</span>;
        <span class="text-primary">protected override</span> <span class="text-info">MagnaKey</span> Key => <span class="text-primary">this</span>.<span class="text-cream">MakeKey</span>(<span class="text-info">cat</span> => <span class="text-info">cat</span>.Id);

        [<span class="text-info">Identity</span>]
        <span class="text-primary">public long</span> Id { <span class="text-primary">get</span>; <span class="text-primary">set</span>; }
        <span class="text-primary">public string</span> Name { <span class="text-primary">get</span>; <span class="text-primary">set</span>; }
        <span class="text-primary">public string</span> Breed { <span class="text-primary">get</span>; <span class="text-primary">set</span>; }
    }
}
</pre>
                      </code>
                    </div>
                    <br />
                    The Cats table (which we previously created in <a href="#table-model">section 3.</a>) has
                    four defined columns, which are <i>Id, Name, Breed, and DateOfBirth</i>; notice that in this
                    example we did not include the DateOfBirth column (just for demonstrational purposes). <br />
                    <br />
                    Let's add some code to our Program class' Main function.<br />
                    <div class="bg-dark p-2">
                      <code>
<pre class="text-light" style="font-size: 14px;">
            ...
            <span class="text-olive">// We'll retrieve all cats from the database using the ToList() static</span>
            <span class="text-olive">// method in our CatView class; this can also be done by using table</span>
            <span class="text-olive">// models (like the Cat class we previously created), but we're</span>
            <span class="text-olive">// using the CatView class just for demonstration.</span>
            <span class="text-primary">var</span> aLotOfMilos = <span class="text-info">CatView</span>.ToList();

            <span class="text-primary">foreach</span>(<span class="text-primary">var</span> item <span class="text-primary">in</span> aLotOfMilos)
            {
                <span class="text-info">Console</span>.WriteLine(<span class="text-brick">"Id: {0}, Name: {1}, Breed: {2}"</span>, item.Id, item.Name, item.Breed);
            }

            <span class="text-info">Console</span>.WriteLine(<span class="text-brick">"{0}Press any key to continue..."</span>, <span class="text-info">Environment</span>.NewLine);
            <span class="text-info">Console</span>.ReadKey();
        }
    }
}
</pre>
                      </code>
                    </div>
                    <br />
                    MagnaDB ViewModels are useful for situations where you wish not to query sensitive
                    information from a database (such as password hashes or phone numbers) while querying
                    just the information you need and not all the columns in the table (which will happen
                    when using a table model, mapped to all the columns in the database table). <br />
                    <br />
                  </p>
                </section>
                <section id="methods">
                  <h2>5. Methods</h2>
                  <div style="height: 900px;"></div>
                </section>
                <section id="attributes">
                  <h2>6. Attributes</h2>
                  <div style="height: 900px;"></div>
                </section>
                <section id="events">
                  <h2>7. Events</h2>
                  <div style="height: 900px;"></div>
                </section>
                <section id="exceptions">
                  <h2>8. Exceptions</h2>
                  <div style="height: 900px;"></div>
                </section>
                <section id="dbengines">
                  <h2>9. Database Engines</h2>
                  <div style="height: 900px;"></div>
                </section>
              </div>
            </div>

          </div>
        
        <script src="js/jquery-3.4.1.min.js"></script>
        <script src="js/popper.min.js"></script>
        <script src="js/bootstrap.min.js"></script>
    </body>
</html>
